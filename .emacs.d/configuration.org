#+TITLE: Emacs Configuration
#+AUTHOR: Terrence Ho
#+EMAIL: terrenceho.books@gmail.com

* My Configuration

This is a literate programming configuration file, written in Org. I can write
code blocks within this file along side documentation, so I can keep track of
everything that is being configured. =org-babel= is used to execute the ELisp
code being written.

* Configure with =use-package=

Use-package is used to install and configure my packages.

The .emacs startup file should already use =use-package=, this ensures that we
are have it already.

#+BEGIN_SRC emacs-lisp
  (require 'use-package-ensure)
  (setq use-package-always-ensure t)
#+END_SRC

** Using the latest sources

Always compile packages, using the newest version available. Run with the
cutting edge.

#+BEGIN_SRC emacs-lisp
  (use-package auto-compile
    :config (auto-compile-on-load-mode))

  (setq load-prefer-newer t)
#+END_SRC

* Overall Configurations
** Using Sensible Defaults

   [[https://github.com/hrs/sensible-defaults.el][sensible-defaults.el]] enables the following:

     - Ensuring that files end with newlines,
     - Always enabling syntax highlighting,
     - Increasing the garbage collection threshold,
     - Defaulting line-length to 80 characters,
     - Creating parent directories after saving a deeply nested file,
     - Making dired file sizes human-readable,

 #+BEGIN_SRC emacs-lisp
 (load "~/code/src/github.com/hrs/sensible-defaults.el/sensible-defaults.el")
 (sensible-defaults/open-files-from-home-directory)
 (sensible-defaults/increase-gc-threshold)
 (sensible-defaults/delete-trailing-whitespace)
 (sensible-defaults/treat-camelcase-as-separate-words)
 (sensible-defaults/automatically-follow-symlinks)
 (sensible-defaults/make-scripts-executable)
 (sensible-defaults/single-space-after-periods)
 (sensible-defaults/offer-to-create-parent-directories-on-save)
 (sensible-defaults/apply-changes-to-highlighted-region)
 (sensible-defaults/overwrite-selected-text)
 (sensible-defaults/ensure-that-files-end-with-newline)
 (sensible-defaults/confirm-closing-emacs)
 (sensible-defaults/quiet-startup)
 (sensible-defaults/make-dired-file-sizes-human-readable)
 (sensible-defaults/shorten-yes-or-no)
 (sensible-defaults/always-highlight-code)
 (sensible-defaults/refresh-buffers-when-files-change)
 (sensible-defaults/show-matching-parens)
 (sensible-defaults/set-default-line-length-to 80)
 (sensible-defaults/open-clicked-files-in-same-frame-on-mac)
 (sensible-defaults/yank-to-point-on-mouse-click)
 (sensible-defaults/use-all-keybindings)
 (sensible-defaults/backup-to-temp-directory)
 (add-hook 'text-mode-hook 'turn-on-auto-fill)
 #+END_SRC

** Color Scheme

Using solarized dark theme.

#+BEGIN_SRC emacs-lisp
;; (use-package solarized-theme
;;   :config
;;   (setq solarized-scale-org-headlines nil)
;;   (setq solarized-use-variable-pitch nil
;;       solarized-height-plus-1 1.0
;;       solarized-height-plus-2 1.0
;;       solarized-height-plus-3 1.0
;;       solarized-height-plus-4 1.0))
;;   (load-theme 'solarized-dark t)
(use-package doom-themes
  :init
  (load-theme 'doom-city-lights t)
  :config
  (setq doom-themes-enable-bold nil    ; if nil, bold is universally disabled
        doom-themes-enable-italic nil) ; if nil, italics is universally disabled
  (doom-themes-org-config)
  )
#+END_SRC

** Personal Information

 #+BEGIN_SRC emacs-lisp
 (setq user-full-name "Terrence Ho"
       user-mail-address "terrenceho.books@gmail.com")
 #+END_SRC
* =evil-mode=

Using =evil-mode= is the only way to use emacs. Provides vim-bindings as an
emulation layer on top of emacs.

Resources:
    - [[https://www.emacswiki.org/emacs/Evil][EmacsWiki/Evil]]
    - [[https://github.com/noctuid/evil-guide][evil-guide]]

#+BEGIN_SRC emacs-lisp
  (use-package evil
    :config
    (evil-mode 1))
#+END_SRC

** Sane splitting

We want to emulate vim's =splitbelow= and =splitright=.

#+BEGIN_SRC emacs-lisp
(setq evil-vsplit-window-right t) ;; like vim's 'splitright'
(setq evil-split-window-below t) ;; like vim's 'splitbelow'
#+END_SRC

** Leader key with =evil-leader=

We want to emulate vim's evil key setup, which enables more configurable
functionality.

#+BEGIN_SRC emacs-lisp
(use-package evil-leader
  :ensure t
  :config
  (global-evil-leader-mode))
;; (evil-leader/set-leader "\\")
(evil-leader/set-key
  "b" 'switch-to-buffer)
#+END_SRC

** =evil-surround=

Enable surround everywhere

#+BEGIN_SRC emacs-lisp
  (use-package evil-surround
    :config
    (global-evil-surround-mode 1))
#+END_SRC

** =evil-commentary=

Easy commenting is always necessary. Press =g c c= to comment a line of code.

#+BEGIN_SRC emacs-lisp
(use-package evil-commentary
    :ensure t
    :bind (:map evil-normal-state-map
                ("gc" . evil-commentary)))
#+END_SRC

** =evil-org=
Use evil with org: sets org-agenda

#+BEGIN_SRC emacs-lisp
  (use-package evil-org
    :after org
    :config
    (add-hook 'org-mode-hook 'evil-org-mode)
    (add-hook 'evil-org-mode-hook
              (lambda () (evil-org-set-key-theme)))
    (require 'evil-org-agenda)
    (evil-org-agenda-set-keys))
#+END_SRC

* =org-mode=

Task Management with Org Mode.

#+BEGIN_SRC emacs-lisp
(use-package org)
(require 'org)
#+END_SRC

** Todo Keywords definitions

We have TODO, IN-PROGRESS, WAITING, and DONE/CANCELLED. DONE/CANCELLED both
represent the finished state.

Explanation of timestamps and notes (=@= represents a note, =!= represents a
timestamp:

- When WAITING, we want to give a timestamp and a note explaining why.
- When DONE, we want to set a timestamp when it was done
- When CANCELLED, we want to give a timestamp and a note explaining why.

Additionally, we set some colors to the TODO states.

#+BEGIN_SRC emacs-lisp
(setq org-todo-keywords
  '((sequence "TODO(t)" "IN-PROGRESS(i)" "WAITING(w@/!)" "|" "DONE(d!)" "CANCELLED(c@/!)")))
(setq org-todo-keyword-faces
      '(("TODO" :foreground "red" :weight bold)
	  ("IN-PROGRESS" :foreground "blue" :weight bold)
	  ("WAITING" :foreground "orange" :weight bold)
	  ("DONE" :foreground "forest green" :weight bold)
	  ("CANCELLED" :foreground "magenta" :weight bold)))

#+END_SRC

** Todo Selection

Change a task state using =C-c C-t KEY=

#+BEGIN_SRC emacs-lisp
(setq org-use-fast-todo-selection t)
#+END_SRC

** Transform asterisks to pretty bullets

#+BEGIN_SRC emacs-lisp
  (use-package org-bullets
    :init
    (add-hook 'org-mode-hook 'org-bullets-mode))
#+END_SRC

** Org downward arrow

I like seeing a little downward-pointing arrow instead of the usual ellipsis
(=...=) that org displays when there's stuff under a header. We also want to set
the ellipsis color to something a little brighter.

#+BEGIN_SRC emacs-lisp
(setq org-ellipsis "â¤µ")
(set-face-attribute 'org-ellipsis nil :foreground "##61a49e")
#+END_SRC

** Syntax highlighting

Use syntax highlighting in source blocks while editing.

#+BEGIN_SRC emacs-lisp
  (setq org-src-fontify-natively t)
  (setq org-src-tab-acts-natively t)
  (setq org-edit-src-content-indentation 0)
#+END_SRC
** Auto New Line at 80 characters

We want our lines to wrap at 80 characters, since that's the nicest way to view
text, even in org mode.

#+BEGIN_SRC emacs-lisp
(add-hook 'org-mode-hook '(lambda () (setq fill-column 80)))
(add-hook 'org-mode-hook 'auto-fill-mode)
#+END_SRC
** Exports

We want to be able to export to several different formats.

*** HTML

#+BEGIN_SRC emacs-lisp
   (use-package htmlize)
#+END_SRC

*** Markdown

This should be handled automatically be handled with =htmlize=

*** Github-Flavored Markdown

Handy for exporting/writing READMEs on Github.

#+BEGIN_SRC emacs-lisp
(use-package ox-gfm)
(eval-after-load "org"
  '(require 'ox-gfm nil t))
#+END_SRC
*** Hugo

Exporting to Hugo compatible markdown allows me to write my blog posts in Org,
then have it converted into markdown.

#+BEGIN_SRC emacs-lisp
(use-package ox-hugo
  :ensure t            ;Auto-install the package from Melpa (optional)
  :after ox)
#+END_SRC

* TODO Emacs Config Setup [1/7]
** TODO Setup Evil [1/3]
*** IN-PROGRESS Setup more familiar key bindings
*** DONE Setup evil leader, set up key bingings
    - State "DONE"       from "TODO"       [2019-06-02 Sun 22:02]
*** IN-PROGRESS Set up plugins
** TODO Set up Org [0/2]
*** TODO Set up org-agenda
*** TODO Set up org calendar
** TODO Set up Projectile
** TODO Set up Helm
** TODO Set up Magit
** DONE Set up Doom Themes
   - State "DONE"       from "TODO"       [2019-06-02 Sun 22:02]
** TODO Set up powerline
